参考信号模式 Edited
功能简介
参考信号功能是用于设计一个信号发生器作为轨迹规划，参考信号会按照设定的参数以及信号类型进行规划。
字典说明
| 参数名称           | 字典名称                        | 主索引 | 子索引 | 数据类型  | 参数范围                 | 读写权限 | 单位                              | 字典指令值含义                                                                                                                                                                                                                                                                                                                                                               |
| ------------------ | ------------------------------- | ------ | ------ | --------- | ------------------------ | -------- | --------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 参考信号类型       | Reference Signal Type           | 0x357C | 0x00   | UNS8      | 1-2                      | RW       | -                                 | 0：step；1：sine                                                                                                                                                                                                                                                                                                                                                             |
| 参考信号控制对象   | Reference Signal Control Object | 0x35E8 | 0x00   | UNS8      | 0-255                    | RW       | -                                 | 1：位置参考信号 2：速度参考信号 3：力矩参考信号 4：AB 轴电压参考信号 5：D 轴电流参考信号                                                                                                                                                                                                                                                                                     |
| 参考信号幅值       | Reference Signal_Amplitude      | 0x357E | 0x01   | INTEGER32 | -2147483647-2147483647   | RW       | -                                 |                                                                                                                                                                                                                                                                                                                                                                              |
| 参考信号频率       | Reference Signal Frequency      | 0x357E | 0x02   | UNS32     | 0-4294967295             | RW       | Hz                                |                                                                                                                                                                                                                                                                                                                                                                              |
| 参考信号偏移       | Reference Signal Offset         | 0x357E | 0x03   | INTEGER32 | -2147483647-2147483647   | RW       | -                                 |                                                                                                                                                                                                                                                                                                                                                                              |
| 参考信号斜率       | Reference Signal Slope          | 0x357E | 0x04   | INTEGER32 | -2147483647-2147483647   | RW       | -                                 |                                                                                                                                                                                                                                                                                                                                                                              |
| 运行模式指令       | Operation Mode Command          | 0x6060 | 0x00   | INTEGER8  | -                        | RW       | -                                 | 0x01：位置模式 0x03：速度模式 0x04：力矩模式 0x06：回零模式 0x0B：力控模式 0x3C：往复运动模式 0x16：模拟量控速度模式 0x17：模拟量控力矩模式 0x1F：脉冲控位置模式 0x3D：参考信号模式 0x2A：PWM 控速模式 0x3E：多段运行模式 0xFF：电气辨识 0xFE：方向辨识 0xFC：极对数辨识 0xFB：Z 相辨识 0xFD：霍尔辨识 0xFA：电角度辨识 0xF9：机械辨识 0xF7：机械特性辨识 0xF8：转矩脉动辨识 |
| 当前运行模式       | Operation Mode Actual           | 0x6061 | 0x00   | INTEGER8  | -                        | RO       | -                                 | 0x01：位置模式 0x03：速度模式 0x04：力矩模式 0x06：回零模式 0x0B：力控模式 0x3C：往复运动模式 0x16：模拟量控速度模式 0x17：模拟量控力矩模式 0x1F：脉冲控位置模式 0x3D：参考信号模式 0x2A：PWM 控速模式 0x3E：多段运行模式 0xFF：电气辨识 0xFE：方向辨识 0xFC：极对数辨识 0xFB：Z 相辨识 0xFD：霍尔辨识 0xFA：电角度辨识 0xF9：机械辨识 0xF7：机械特性辨识 0xF8：转矩脉动辨识 |
| 控制字             | DS402 Controlword               | 0x6040 | 0x00   | UNS16     | -                        | RW       | -                                 |                                                                                                                                                                                                                                                                                                                                                                              |
| 状态字             | DS402 Statusword                | 0x6041 | 0x00   | UNS16     | -                        | RW       | -                                 |                                                                                                                                                                                                                                                                                                                                                                              |
| 电机运行状态       | Motor Operation Status          | 0x3005 | 0x00   | UNS8      | 0~255                    | RO       | -                                 | 0：电机失能 1：电机使能                                                                                                                                                                                                                                                                                                                                                      |
| 电机端速度当前值   | Motor Velocity Actual Value     | 0x3574 | 0x00   | INTEGER32 | -2147483648~2147483647   | RO       | VelCU（速度坐标转换，用户单位）   |                                                                                                                                                                                                                                                                                                                                                                              |
| 负载端速度当前值   | Load Velocity Actual Value      | 0x606C | 0x00   | INTEGER32 | -2147483648~2147483647   | RO       | VelCU（速度坐标转换，用户单位）   |                                                                                                                                                                                                                                                                                                                                                                              |
| 电机端速度误差值   | Motor Velocity Error Value      | 0x3575 | 0x00   | INTEGER32 | -2147483648~2147483647   | RO       | VelCU（速度坐标转换，用户单位）   |                                                                                                                                                                                                                                                                                                                                                                              |
| 负载端速度误差值   | Load Velocity Error Value       | 0x351E | 0x00   | INTEGER32 | -2147483648~2147483647   | RO       | VelCU（速度坐标转换，用户单位）   |                                                                                                                                                                                                                                                                                                                                                                              |
| 电机端位置当前值   | Motor Position Actual Value     | 0x3572 | 0x00   | INTEGER32 | -2147483648 ~ 2147483647 | RO       | PosCU（位置坐标转换，用户单位）   |                                                                                                                                                                                                                                                                                                                                                                              |
| 负载端位置当前值   | Load Position Actual Value      | 0x6064 | 0x00   | INTEGER32 | -2147483648 ~ 2147483647 | RO       | PosCU（位置坐标转换，用户单位）   |                                                                                                                                                                                                                                                                                                                                                                              |
| 电机端位置误差     | Motor Position Error Value      | 0x3573 | 0x00   | INTEGER32 | -2147483648 ~ 2147483647 | RO       | PosCU（位置坐标转换，用户单位）   |                                                                                                                                                                                                                                                                                                                                                                              |
| 负载端位置误差     | Load Position Error Value       | 0x60F4 | 0x00   | INTEGER32 | -2147483648 ~ 2147483647 | RO       | PosCU（位置坐标转换，用户单位）   |                                                                                                                                                                                                                                                                                                                                                                              |
| 电流当前值         | Current Actual Value            | 0x6078 | 0x00   | INTEGER16 | -32758~32767             | RO       | TqCU（转矩坐标转换，用户单位‰）  |                                                                                                                                                                                                                                                                                                                                                                              |
| 电流误差值         | Current Error Value             | 0x351F | 0x00   | INTEGER32 | -2147483648~2147483647   | RO       | TqCU（转矩坐标转换，用户单位 mA） |                                                                                                                                                                                                                                                                                                                                                                              |
| Alpha 轴电压目标值 | Axis Alpha Voltage Target Value | 0x35F4 | 0x00   | INTEGER32 | -2147483648~2147483647   | RW       | mV                                |                                                                                                                                                                                                                                                                                                                                                                              |
| Beta 轴电压目标值  | Axis Beta Voltage Target Value  | 0x35F5 | 0x00   | INTEGER32 | -2147483648~2147483647   | RW       | mV                                |                                                                                                                                                                                                                                                                                                                                                                              |
| Alpha 轴电压指令值 | Axis Alpha Voltage Demand Value | 0x35F9 | 0x00   | INTEGER32 | -2147483648~2147483647   | RO       | mV                                |                                                                                                                                                                                                                                                                                                                                                                              |
| Beta 轴电压指令值  | Axis Beta Voltage Demand Value  | 0x35FA | 0x00   | INTEGER32 | -2147483648~2147483647   | RO       | mV                                |                                                                                                                                                                                                                                                                                                                                                                              |
| D 轴电流目标值     | Axis D Current Target Value     | 0x35F2 | 0x00   | INTEGER32 | -2147483648~2147483647   | RW       | mA                                |                                                                                                                                                                                                                                                                                                                                                                              |
| D 轴电流指令值     | Axis D Current Demand Value     | 0x35F3 | 0x00   | INTEGER32 | -2147483648~2147483647   | RO       | mA                                |                                                                                                                                                                                                                                                                                                                                                                              |
状态字解析
通用定义（各个模式都通用）：
| bit15 | bit14 | bit13 | bit12 | bit11 | bit10 | bit9 | bit8 | bit7 | bit6 | bit5 | bit4 | bit3 | bit2 | bit1 | bit0 |
| ----- | ----- | ----- | ----- | ----- | ----- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 0     | 0     | 0     | 0     | 0     | 0     | 1    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    |
| ms    | ms    | oms   | oms   | ila   | tr    | rm   | ms   | w    | sod  | qs   | ve   | f    | oe   | so   | rtso |
ms = manufacturer-specific（厂家自定义）
oms = operation mode specific（模式定义）
ila = internal limit active（如果 bit11 置 1，则表明触发内部位置限制）
tr = target reached（如果 bit10 置 1，则表明目标到达）
rm = remote （远程控制。如果 bit9 置 1，则表示 CANopen 远程控制模式）
w = warning（如果 bit7 置 1，则表明警告）
sod = switch on disabled（如果 bit6 置 1，则表明伺服未接通 PWM）
qs = quick stop（如果 bit5 置 0，则表明急停）
ve = voltage enabled（如果 bit4 置 1，则表明驱动器已接通电源）
f = fault（如果 bit3 置 1，则表明处于错误状态）
oe = operation enabled（如果 bit2 置 1，则表明伺服运行）
so = switched on（如果 bit1 置 1，则表明伺服已接通 PWM）
rtso = ready to switch on（如果 bit0 置 1，则表明伺服未准备好）
状态字 bit0-bit3，bit5，bit6 定义
| Value(binary)       | State                  |
| ------------------- | ---------------------- |
| xxxx xxxx x0xx 0000 | Not ready to switch on |
| xxxx xxxx x1xx 0000 | Switch on disabled     |
| xxxx xxxx x01x 0001 | Ready to switch on     |
| xxxx xxxx x01x 0011 | Switched on            |
| xxxx xxxx x01x 0111 | Operation enabled      |
| xxxx xxxx x00x 0111 | Quick stop active      |
| xxxx xxxx x0xx 1111 | Fault reaction active  |
| xxxx xxxx x0xx 1000 | Fault                  |
状态字 Bit10、Bit12、Bit13 定义：
| Bit | Value | Definition                                                                            |
| ------- | --------- | ----------------------------------------------------------------------------------------- |
| 10      | 0         | Halt (Bit 8 in controlword) = 0: Target  not reached 控制字 bit8 = 0 时，表示目标未到达   |
|         |           | Halt (Bit 8 in controlword) = 1: Axis decelerates 控制字 bit8 = 1 时，表示轴减速中        |
|         | 1         | Halt (Bit 8 in controlword) = 0: Target  reached 控制字 bit8 = 0 时，表示目标已到达       |
|         |           | Halt (Bit 8 in controlword) = 1: Velocity of axis is 0 控制字 bit8 = 1 时，表示轴速度为 0 |
| 12      | -         | Reserved                                                                                  |
| 13      | -         | Reserved                                                                                  |
模式下控制字使用
模式动作对应的控制字：
| 动作    | 驱动器状态                         | 对应控制字 |
| ----------- | -------------------------------------- | -------------- |
| 失能        | Switch on disabled->Ready to switch on | 0x06           |
| 失能-> 使能 | Switch on disabled->Operation  enabled | 0x0F           |
|             | Ready to switch on->Operation  enabled |                |
| 使能-> 暂停 | Operation enabled->Operation enabled   | 0x010F         |
| 使能-> 失能 | Operation enabled->Ready to switch on  | 0x06           |
|             | Operation enabled->Switch on disabled  | 0x05           |
| 暂停-> 继续 | Operation enabled->Operation enabled   | 0x0F           |
| 暂停-> 失能 | Operation enabled->Ready to switch on  | 0x06           |
|             | Operation enabled->Switch on disabled  | 0x05           |
| 故障-> 失能 | Fault->Switch on diabled               | 0x86           |
模式设置流程

以上媒体的描述: 这是一张流程图，描述了一个控制系统的操作流程。流程图中包含以下步骤和决策点：

检测驱动器当前状态

查询状态字（0x6041=0x00）


决策点：状态字是否为Ready to switch on?

如果否：发送控制字0x06（0x6040=0x06）

如果是：使能电机


使能电机


发送控制字使能（0x6040=0x0F）


查询电机状态


查询电机状态（0x3005=0x00）


决策点：电机是否已经使能？

如果否：返回使能电机步骤

如果是：继续


决策点：运行过程是否暂停？

如果否：继续运行

如果是：读取控制字


读取控制字

将控制字第8位置1并发送（0x6040=0x10F）
读取控制字

将控制字第8位置0并发送（0x6040=0x0F）


继续运行

发送新的目标值

这个流程图详细描述了一个控制系统的状态检测、使能电机、查询电机状态以及运行过程中的控制逻辑。