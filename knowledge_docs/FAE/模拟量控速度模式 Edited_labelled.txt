模拟量控速度模式 Edited
功能简介
模拟量控速度功能是通过模拟量输入的电压值来控制驱动器规划电机运行到指定的”目标速度“。
字典说明
| 参数名称            | 字典名称                           | 主索引 | 子索引 | 数据类型  | 参数范围               | 读写权限 | 单位                              | 字典指令值含义                                                                                                                                                                                                                                                                                                                                                               |
| ------------------- | ---------------------------------- | ------ | ------ | --------- | ---------------------- | -------- | --------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 运行模式指令        | Operation Mode Command             | 0x6060 | 0x00   | INTEGER8  | -                      | RW       | -                                 | 0x01：位置模式 0x03：速度模式 0x04：力矩模式 0x06：回零模式 0x0B：力控模式 0x3C：往复运动模式 0x16：模拟量控速度模式 0x17：模拟量控力矩模式 0x1F：脉冲控位置模式 0x3D：参考信号模式 0x2A：PWM 控速模式 0x3E：多段运行模式 0xFF：电气辨识 0xFE：方向辨识 0xFC：极对数辨识 0xFB：Z 相辨识 0xFD：霍尔辨识 0xFA：电角度辨识 0xF9：机械辨识 0xF7：机械特性辨识 0xF8：转矩脉动辨识 |
| 当前运行模式        | Operation Mode Actual              | 0x6061 | 0x00   | INTEGER8  | -                      | RO       | -                                 | 0x01：位置模式 0x03：速度模式 0x04：力矩模式 0x06：回零模式 0x0B：力控模式 0x3C：往复运动模式 0x16：模拟量控速度模式 0x17：模拟量控力矩模式 0x1F：脉冲控位置模式 0x3D：参考信号模式 0x2A：PWM 控速模式 0x3E：多段运行模式 0xFF：电气辨识 0xFE：方向辨识 0xFC：极对数辨识 0xFB：Z 相辨识 0xFD：霍尔辨识 0xFA：电角度辨识 0xF9：机械辨识 0xF7：机械特性辨识 0xF8：转矩脉动辨识 |
| 控制字              | DS402 Controlword                  | 0x6040 | 0x00   | UNS16     | -                      | RW       | -                                 |                                                                                                                                                                                                                                                                                                                                                                              |
| 状态字              | DS402 Statusword                   | 0x6041 | 0x00   | UNS16     | -                      | RW       | -                                 |                                                                                                                                                                                                                                                                                                                                                                              |
| 速度指令值          | Velocity Demand Value              | 0x606B | 0x00   | INTEGER32 | -2147483648~2147483647 | RW       | VelCU（速度坐标转换，用户单位）   |                                                                                                                                                                                                                                                                                                                                                                              |
| 应用速度限制        | Application Speed Limit            | 0x607F | 0x00   | UNS32     | 0 ~ 4294967295         | RW       | VelUU（单位转换，用户单位）       |                                                                                                                                                                                                                                                                                                                                                                              |
| 轮廓加速度          | Profile Acceleration               | 0x6083 | 0x00   | UNS32     | 0 ~ 4294967295         | RW       | AccUU（加速度单位转换，用户单位） |                                                                                                                                                                                                                                                                                                                                                                              |
| 轮廓减速度          | Profile Deceleration               | 0x6084 | 0x00   | UNS32     | 0 ~ 4294967295         | RW       | AccUU（加速度单位转换，用户单位） |                                                                                                                                                                                                                                                                                                                                                                              |
| 应用加速度限制      | Application Acceleration Limit     | 0x60C5 | 0x00   | UNS32     | 0 ~ 4294967295         | RW       | AccUU（加速度单位转换，用户单位） |                                                                                                                                                                                                                                                                                                                                                                              |
| 应用减速度限制      | Application Deceleration Limit     | 0x60C6 | 0x00   | UNS32     | 0 ~ 4294967295         | RW       | AccUU（加速度单位转换，用户单位） |                                                                                                                                                                                                                                                                                                                                                                              |
| 电机端速度当前值    | Motor Velocity Actual Value        | 0x3574 | 0x00   | INTEGER32 | -2147483648~2147483647 | RO       | VelCU（速度坐标转换，用户单位）   |                                                                                                                                                                                                                                                                                                                                                                              |
| 负载端速度当前值    | Load Velocity Actual Value         | 0x606C | 0x00   | INTEGER32 | -2147483648~2147483647 | RO       | VelCU（速度坐标转换，用户单位）   |                                                                                                                                                                                                                                                                                                                                                                              |
| 电机端速度误差值    | Motor Velocity Error Value         | 0x3575 | 0x00   | INTEGER32 | -2147483648~2147483647 | RO       | VelCU（速度坐标转换，用户单位）   |                                                                                                                                                                                                                                                                                                                                                                              |
| 负载端速度误差值    | Load Velocity Error Value          | 0x351E | 0x00   | INTEGER32 | -2147483648~2147483647 | RO       | VelCU（速度坐标转换，用户单位）   |                                                                                                                                                                                                                                                                                                                                                                              |
| 电机运行状态        | Motor Operation Status             | 0x3005 | 0x00   | UNS8      | 0~255                  | RO       | -                                 | 0：电机失能 1：电机使能                                                                                                                                                                                                                                                                                                                                                      |
| 模拟量控制信号源    | Analog Control Signal Source       | 0x35A8 | 0x00   | UNS8      | 0-255                  | RW       | 1：ADC12：ADC2                    |                                                                                                                                                                                                                                                                                                                                                                              |
| 模拟输入信号 1 死区 | Analog Input 21Deadzone            | 0x366F | 0x00   | UNS32     | 0~65535                | RW       | -                                 |                                                                                                                                                                                                                                                                                                                                                                              |
| 模拟输入信号 2 死区 | Analog Input 2 Deadzone            | 0x3670 | 0x00   | UNS32     | 0~65535                | RW       | -                                 |                                                                                                                                                                                                                                                                                                                                                                              |
| ADC1 采样偏移       | ADC1 Sampling Offset               | 0x35B4 | 0x01   | INTEGER32 | -2147483648-2147483647 | RW       | -                                 |                                                                                                                                                                                                                                                                                                                                                                              |
| ADC2 采样偏移值     | ADC2 Sampling Offset               | 0x35B4 | 0x02   | INTEGER32 | -2147483648-2147483647 | RW       |                                   |                                                                                                                                                                                                                                                                                                                                                                              |
| ADC1 降低分辨率     | ADC1 Sampling Resolution Reduction | 0x35A9 | 0x00   | UNS32     | 0-31                   | RW       | -                                 |                                                                                                                                                                                                                                                                                                                                                                              |
| ADC2 降低分辨率     | ADC2 Sampling Resolution Reduction | 0x35AA | 0x00   | UNS32     | 0-31                   | RW       | -                                 |                                                                                                                                                                                                                                                                                                                                                                              |
| ADC 用户电压下限    | ADC User Voltage Lower Limit       | 0x3652 | 0x00   | INTEGER32 | -2147483648-2147483647 | RW       | mV                                |                                                                                                                                                                                                                                                                                                                                                                              |
| ADC 用户电压上限    | ADC User Voltage Upper Limit       | 0x3653 | 0x00   | INTEGER32 | -2147483648-2147483647 | RW       | mV                                |                                                                                                                                                                                                                                                                                                                                                                              |
| ADC1 原始数据当前值 | ADC1 Raw Data Actual Value         | 0x358B | 0x00   | INTEGER32 | -2147483648-2147483647 | RW       | -                                 |                                                                                                                                                                                                                                                                                                                                                                              |
| ADC2 原始数据当前值 | ADC2 Raw Data Actual Value         | 0x358C | 0x00   | INTEGER32 | -2147483648-2147483647 | RW       | -                                 |                                                                                                                                                                                                                                                                                                                                                                              |
| ADC1 电压范围       | ADC1 Voltage Range                 | 0x3578 | 0x00   | UNS8      | 0~11                   | RW       |                                   |                                                                                                                                                                                                                                                                                                                                                                              |
| ADC2 电压范围       | ADC2 Voltage Range                 | 0x3579 | 0x00   | UNS8      | 0~11                   | RW       |                                   |                                                                                                                                                                                                                                                                                                                                                                              |
状态字解析
通用定义（各个模式都通用）：
| bit15 | bit14 | bit13 | bit12 | bit11 | bit10 | bit9 | bit8 | bit7 | bit6 | bit5 | bit4 | bit3 | bit2 | bit1 | bit0 |
| ----- | ----- | ----- | ----- | ----- | ----- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- | ---- |
| 0     | 0     | 0     | 0     | 0     | 0     | 1    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    | 0    |
| ms    | ms    | oms   | oms   | ila   | tr    | rm   | ms   | w    | sod  | qs   | ve   | f    | oe   | so   | rtso |
ms = manufacturer-specific（厂家自定义）
oms = operation mode specific（模式定义）
ila = internal limit active（如果 bit11 置 1，则表明触发内部位置限制）
tr = target reached（如果 bit10 置 1，则表明目标到达）
rm = remote （远程控制。如果 bit9 置 1，则表示 CANopen 远程控制模式）
w = warning（如果 bit7 置 1，则表明警告）
sod = switch on disabled（如果 bit6 置 1，则表明伺服未接通 PWM）
qs = quick stop（如果 bit5 置 0，则表明急停）
ve = voltage enabled（如果 bit4 置 1，则表明驱动器已接通电源）
f = fault（如果 bit3 置 1，则表明处于错误状态）
oe = operation enabled（如果 bit2 置 1，则表明伺服运行）
so = switched on（如果 bit1 置 1，则表明伺服已接通 PWM）
rtso = ready to switch on（如果 bit0 置 1，则表明伺服未准备好）
状态字 bit0-bit3，bit5，bit6 定义
| Value(binary)       | State                  |
| ------------------- | ---------------------- |
| xxxx xxxx x0xx 0000 | Not ready to switch on |
| xxxx xxxx x1xx 0000 | Switch on disabled     |
| xxxx xxxx x01x 0001 | Ready to switch on     |
| xxxx xxxx x01x 0011 | Switched on            |
| xxxx xxxx x01x 0111 | Operation enabled      |
| xxxx xxxx x00x 0111 | Quick stop active      |
| xxxx xxxx x0xx 1111 | Fault reaction active  |
| xxxx xxxx x0xx 1000 | Fault                  |
状态字 Bit10、Bit12、Bit13 定义：
| Bit | Value | Definition含义                                                                              |
| ------- | --------- | --------------------------------------------------------------------------------------------------- |
| 10      | 0         | Halt (Bit 8 in controlword) = 0: Target velocity not reached 控制字 bit8 = 0 时，表示目标速度未到达 |
|         |           | Halt (Bit 8 in controlword) = 1: Axis decelerates 控制字 bit8 = 1 时，表示轴减速中                  |
|         | 1         | Halt (Bit 8 in controlword) = 0: Target velocity reached 控制字 bit8 = 0 时，表示目标速度已到达     |
|         |           | Halt (Bit 8 in controlword) = 1: Velocity of axis is 0 控制字 bit8 = 1 时，表示轴速度为 0           |
| 12      | -         | -                                                                                                   |
| 13      | -         | -                                                                                                   |
模式下控制字使用
模式动作对应的控制字：
| 动作    | 驱动器状态                         | 对应控制字 |
| ----------- | -------------------------------------- | -------------- |
| 失能        | Switch on disabled->Ready to switch on | 0x06           |
| 失能-> 使能 | Switch on disabled->Operation  enabled | 0x0F           |
|             | Ready to switch on->Operation  enabled |                |
| 使能-> 失能 | Operation enabled->Ready to switch on  | 0x06           |
|             | Operation enabled->Switch on disabled  | 0x05           |
| 故障-> 失能 | Fault->Switch on diabled               | 0x86           |
模式下设置流程

以上媒体的描述: 这是一张流程图，描述了一个驱动器的状态检测和控制流程。流程图的主要内容如下：

检测驱动器当前状态

查询状态字 {0x6041-0x00}


状态字是否为 Ready to switch on?

如果否，发送控制字 0x06 {0x6040-0x00 = 0x06}

如果是，继续下一步


使能电机

发送控制字使能 {0x6040-0x00 = 0x0F}

查询电机状态 {0x3005-0x00}


检查电机是否已经使能

如果否，发送控制字清除错误 {0x6040-0x00 = 0x86}

如果是，继续下一步


运行过程中是否故障？

如果是，发送控制字清除错误 {0x6040-0x00 = 0x86}

如果否，继续下一步


继续运行

输入新的模拟量

这个流程图展示了一个驱动器从状态检测到使能电机，再到运行过程中故障处理的完整流程。